''' html export url

Sub img_url()

Dim HTMLDoc As New MSHTML.HTMLDocument
    Dim TDelements As IHTMLElementCollection
    Dim tdimg As HTMLImg
    
    HTMLDoc.body.innerHTML = Range("A1").Text
    
    Set TDelements = HTMLDoc.getElementsByTagName("img")
    
    For Each tdimg In TDelements
    
        Debug.Print tdimg.src
    Next
End Sub


'' URL 
Function URLExists(url As String) As Boolean
    Dim Request As Object
    Dim ff As Integer
    Dim rc As Variant
    
    On Error GoTo EndNow
    Set Request = CreateObject("WinHttp.WinHttpRequest.5.1")
    
    With Request
      .Open "GET", url, False
      .Send
      rc = .StatusText
    End With
    Set Request = Nothing
    If rc = "OK" Then URLExists = True
    
    Exit Function
EndNow:
End Function


Sub fn_url_check()
    Dim rng As Range
    Dim rslt As Boolean
    For Each rng In Range("RNG_URL")
        rng.Offset(, 1).Value = URLExists(rng.Value)
    Next
    
    MsgBox "end"
End Sub

'"열기" 버튼에 연결된 매크로

Sub open_NewWindow()
   
    Sheets("Sheet2").Visible = True                 '숨겨진 창을 활성화
    ActiveWindow.NewWindow                        '새창열기
   
    Sheets("Sheet2").Select
    With ActiveWindow                                    '활성화된 창에서
        .WindowState = xlNormal                        '창의 설정을 일반으로
        .Width = 300                                         '창의 폭을 200으로
        .Height = 200                                        '창의 높이를 150으로
        .Top = 100                                            '창의 윗쪽 위치를 100에
        .Left = 100                                            '창의 왼쪽 위치를 100에
    End With

End Sub

 

'"닫기" 버튼에 연결된 매크로

Sub close_NewWindow()
    Sheets("Sheet2").Visible = False                 '활성화된 Sheet2를 숨기기
    ActiveWindow.Close                                  'Sheet2창을 닫음
    ActiveWindow.WindowState = xlMaximized    '창 크기를 최대로
End Sub




Sub test02()
Dim driver As New WebDriver
Dim rowc, cc, columnC As Integer
driver.Start "Chrome"
driver.Get "http://demo.guru99.com/test/web-table-element.php"
Application.Wait Now + TimeValue("00:03:00")
End Sub


Sub fn_Explorer()
Dim window As Object
Dim Page

Set window = CreateObject("internetexplorer.application")
window.Visible = True
window.navigate "https://nid.naver.com/nidlogin.login"
Application.Wait Now + TimeSerial(0, 0, 2)

'
'Set Page = window.document
'With Page.all
    '.Item("id").Value = ActiveSheet.Cells(2, 2).Value
    '.Item("pw").Value = ActiveSheet.Cells(2, 3).Value
'End With
'
'SendKeys "{ENTER}", True


window.Quit
End Sub
